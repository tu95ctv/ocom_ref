<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="website_sale_delivery.payment_delivery" name="Delivery Costs" inherit_id="website_sale.payment">
        <xpath expr="//div[@id='shipping_and_billing']" position="inside">
            <t t-foreach="website_sale_order.sol_gr_ids.company_id" t-as="company_id">
                <h3 t-field="company_id.name" />
                <t t-set="delivery_nb" t-value="deliveries and len(deliveries)"/>
                <div t-if="delivery_nb == 1" id="delivery_carrier" class="mt4">
                    <p  class="company_id" t-att-value="company_id.name"></p>
                    <b>Shipping Method: </b>
                    <t t-foreach="deliveries" t-as="delivery">
                        <t t-call="website_sale_delivery.payment_delivery_methods"/>
                    </t>
                </div>
                <!-- <div t-if="deliveries" t-attf-data-id="delivery_carrier_#{company_id}"> -->

                <div t-if="deliveries" id="delivery_carrier">
                    
                    <t t-set="delivery_nb" t-value="len(deliveries)"/>
                    <h3 t-if="delivery_nb &gt; 1" class="mb24">Choose a delivery method</h3>
                    <!-- <div t-if="delivery_nb &gt; 1" class="card border-0" id="delivery_method"> -->
                    <div t-if="delivery_nb &gt; 1" class="card border-0" t-attf-data-id="delivery_method#{company_id.id}">
                        <p  class="company_id" t-att-value="company_id.name"></p>
                        <ul class="list-group">
                            <t t-foreach="deliveries" t-as="delivery">
                                <li class="list-group-item o_delivery_carrier_select">
                                    <t t-call="website_sale_delivery.payment_delivery_methods"/>
                                </li>
                            </t>
                        </ul>
                    </div>
                </div>

            </t>
        </xpath>
        <xpath expr="//div[@id='payment_method']" position="attributes">
            <attribute name="t-att-style">'display: none!important' if not deliveries and delivery_has_storable else ''</attribute>
        </xpath>
    </template>

    <template id="website_sale_delivery.payment_delivery_methods">
        <!-- <input t-att-company="company_id.id" t-att-value="delivery.id" t-att-id="'delivery_%i' % delivery.id" type="radio" name="delivery_type" t-att-checked="order.carrier_id and order.carrier_id.id == delivery.id and 'checked' or False" t-att-class="'d-none' if delivery_nb == 1 else ''"/> -->
        
        <input t-att-company="company_id.id" t-att-value="delivery.id" t-att-id="'delivery_%i' % delivery.id" type="radio" name1="delivery_type" t-attf-name="delivery_type_#{company_id.id}" t-att-checked="order.carrier_id and order.carrier_id.id == delivery.id and 'checked' or False" t-att-class="'d-none' if delivery_nb == 1 else ''"/>
        <label class="label-optional" t-field="delivery.name"/>
        <t t-set='badge_class' t-value="(delivery_nb != 1 and 'float-right ' or '') + 'badge badge-secondary'" />
        <t t-if="delivery.delivery_type == 'fixed'">
          <span t-if="delivery.fixed_price > 0.0" t-att-class="badge_class">
            <t t-esc="delivery.rate_shipment(website_sale_order)['price'] if delivery.free_over else delivery.fixed_price"
               t-options='{"widget": "monetary",
                           "from_currency": website_sale_order.currency_id if delivery.free_over else delivery.product_id.company_id.currency_id or website_sale_order.company_id.currency_id,
                           "display_currency": website_sale_order.currency_id}'/>
          </span>
          <span t-else="" t-att-class="badge_class">Free</span>
        </t>
        <t t-else="">
            <span t-attf-class="#{badge_class} o_wsale_delivery_badge_price">Select to compute delivery rate</span>
        </t>
        <t t-if="delivery.website_description">
            <div t-field="delivery.website_description" class="text-muted mt8"/>
        </t>
    </template>


</odoo>
